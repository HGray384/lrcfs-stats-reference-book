# Likelihood ratio as value of evidence {#likelihood-ratio}

```{r package-load-likelihood-ratio, include=FALSE}
source("./code/helper-functions.R")
# check and load the libraries
needPackages("igraph",
              "ggthemes",
              "kableExtra",
              "tidyverse")
# set some useful variables
source("./code/useful-variables.R")
```

This Chapter introduces the likelihood ratio

## What is the likelihood ratio?

## Why is it used?

## Example: doping

Recall the example of detecting doping athletes from Chapter \@ref(false-positives). The test returns positive for 95 out of every 100 doping athletes. The test returns negative for 95 out of every 100 non-doping athletes. Assuming the base rate that 2 out of every 100 athletes are doping, we were able to deduce that only 28 out of every 100 athletes who receive a positive test are actually doping. Is the test bad?

The likelihood ratio can help us think about this. One of the purposes of drugs testing Before testing, if we randomly selected an athlete then only 2 out of 100 of them would be doping. After testing, if we randomly selected from those with positive tests then about 28 out of every 100 would be doping. 

```{r freq-tree-lr-doping, echo=FALSE,fig.cap="Out of the 680 athletes who test positive (shown in bold font), 190 (~28%) are doping. ", out.width = '80%', fig.align = 'center'}
e <- c(1, 2, 1, 3, 2, 4, 2, 5, 3, 6, 3, 7)
v <- c("10,000 \nathletes", "200\ndoping", "9,800\nnot doping", "190\npositive", "10\nnegative", "490\npositive", "9,310\nnegative")
freqTree <- graph(edges=e, n=7, directed=FALSE)
V(freqTree)$name <- v

colPal <- colorblind_pal()(8)
# the commented code below complicates the point
# V(freqTree)$color <- c(rep(colPal[1], 3), 
#                        colPal[4], 
#                        colPal[7],
#                        colPal[7],
#                        colPal[4])
V(freqTree)$color <- c(rep(colPal[1], 7))
V(freqTree)$label.font <- c(rep(1, 3), 2, 1, 2, 1)
par(mar = c(0, 0, 0, 0))
plot(freqTree, vertex.shape="none", vertex.label=V(freqTree)$name,
     vertex.label.color=V(freqTree)$color, vertex.label.font=V(freqTree)$label.font,
     vertex.label.cex=1.2, edge.color="grey70",  edge.width=2,
     layout=layout_as_tree(graph = freqTree, root = 1),
     vertex.size=50)
# legend("bottomright", legend=c("True", "False"),
#        col=colPal[c(4,7)], bty = "n",
#        pch=16)
par(mar = defMar)
```

## More information

## Exercises